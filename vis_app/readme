Adapted from trevr martin's reddit subalgebra and visualization tools
